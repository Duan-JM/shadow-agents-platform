# é˜¶æ®µäºŒï¼šåˆ›å»ºé¡¹ç›®åŸºç¡€ç»“æ„

## ç›®æ ‡
åŸºäºé˜¶æ®µä¸€çš„åˆ†æç»“æœï¼Œæ­å»ºæ–°é¡¹ç›®çš„ç›®å½•ç»“æ„å’ŒåŸºç¡€é…ç½®æ–‡ä»¶ï¼Œä¸ºåç»­å¼€å‘å·¥ä½œå‡†å¤‡å¥½æ¡†æ¶ã€‚

---

## æ€»ä½“æ€è·¯

### è®¾è®¡åŸåˆ™
1. **æ¨¡å—åŒ–**ï¼šæ¸…æ™°çš„æ¨¡å—åˆ’åˆ†ï¼Œä¾¿äºç»´æŠ¤
2. **ç®€æ´æ€§**ï¼šå»é™¤éå¿…è¦çš„å¤æ‚æ€§
3. **å¯é…ç½®**ï¼šæ”¯æŒçµæ´»çš„é…ç½®ç®¡ç†
4. **ä¸­æ–‡åŒ–**ï¼šæ‰€æœ‰æ–‡æ¡£å’Œæ³¨é‡Šä½¿ç”¨ä¸­æ–‡

### é¡¹ç›®å‘½å
å»ºè®®é¡¹ç›®åç§°ï¼š**Shadow Agents Platform**ï¼ˆå½±å­æ™ºèƒ½ä½“å¹³å°ï¼‰

---

## è¯¦ç»†æ‰§è¡Œæ­¥éª¤

### æ­¥éª¤ 1ï¼šåˆ›å»ºé¡¶å±‚ç›®å½•ç»“æ„

#### 1.1 ç›®å½•è§„åˆ’
```
shadow-agents-platform/
â”œâ”€â”€ api/                      # åç«¯ API æœåŠ¡
â”œâ”€â”€ web/                      # å‰ç«¯ Web åº”ç”¨
â”œâ”€â”€ docker/                   # Docker é…ç½®
â”œâ”€â”€ docs/                     # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ scripts/                  # è„šæœ¬å·¥å…·
â”œâ”€â”€ .gitignore               # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .editorconfig            # ç¼–è¾‘å™¨é…ç½®
â”œâ”€â”€ LICENSE                  # å¼€æºåè®®
â”œâ”€â”€ README.md                # é¡¹ç›®è¯´æ˜
â””â”€â”€ CHANGELOG.md             # å˜æ›´æ—¥å¿—
```

#### 1.2 æ‰§è¡ŒåŠ¨ä½œ
```bash
# åˆ›å»ºä¸»è¦ç›®å½•
mkdir -p api web docker docs scripts
mkdir -p docs/{architecture,plans,guides,api-reference}

# åˆ›å»ºå­ç›®å½•
mkdir -p docker/{nginx,postgres,redis,volumes}
mkdir -p scripts/{deployment,development,migration}
```

---

### æ­¥éª¤ 2ï¼šåˆ›å»ºåç«¯åŸºç¡€ç»“æ„

#### 2.1 API ç›®å½•ç»“æ„
```
api/
â”œâ”€â”€ app.py                    # åº”ç”¨å…¥å£
â”œâ”€â”€ app_factory.py            # Flask åº”ç”¨å·¥å‚
â”œâ”€â”€ requirements.txt          # ä¾èµ–åˆ—è¡¨ï¼ˆç®€åŒ–ç‰ˆï¼‰
â”œâ”€â”€ pyproject.toml           # é¡¹ç›®é…ç½®
â”œâ”€â”€ .env.example             # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ Dockerfile               # Docker é•œåƒæ„å»º
â”œâ”€â”€ configs/                 # é…ç½®æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ app_config.py       # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ db_config.py        # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ middleware_config.py # ä¸­é—´ä»¶é…ç½®
â”œâ”€â”€ controllers/             # æ§åˆ¶å™¨å±‚ï¼ˆAPI è·¯ç”±ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ console/            # æ§åˆ¶å° API
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth/           # è®¤è¯ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ app/            # åº”ç”¨ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ workspace/      # å·¥ä½œç©ºé—´
â”‚   â”‚   â””â”€â”€ dataset/        # æ•°æ®é›†ç®¡ç†
â”‚   â””â”€â”€ service/            # æœåŠ¡ API
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ completion/     # å¯¹è¯å®Œæˆ
â”‚       â””â”€â”€ workflow/       # å·¥ä½œæµæ‰§è¡Œ
â”œâ”€â”€ core/                    # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ app/                # åº”ç”¨æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ entities/       # å®ä½“å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ features/       # åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â””â”€â”€ runners/        # æ‰§è¡Œå™¨
â”‚   â”œâ”€â”€ workflow/           # å·¥ä½œæµå¼•æ“
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ nodes/          # å·¥ä½œæµèŠ‚ç‚¹
â”‚   â”‚   â”œâ”€â”€ engine/         # æ‰§è¡Œå¼•æ“
â”‚   â”‚   â””â”€â”€ graph/          # å›¾å¤„ç†
â”‚   â”œâ”€â”€ rag/                # æ£€ç´¢å¢å¼ºç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ datasource/     # æ•°æ®æº
â”‚   â”‚   â”œâ”€â”€ retrieval/      # æ£€ç´¢
â”‚   â”‚   â””â”€â”€ embedding/      # å‘é‡åŒ–
â”‚   â””â”€â”€ model_runtime/      # æ¨¡å‹è¿è¡Œæ—¶
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ providers/      # æ¨¡å‹æä¾›å•†
â”‚       â””â”€â”€ entities/       # æ¨¡å‹å®ä½“
â”œâ”€â”€ models/                  # æ•°æ®æ¨¡å‹ï¼ˆORMï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ account.py          # ç”¨æˆ·è´¦æˆ·
â”‚   â”œâ”€â”€ app.py              # åº”ç”¨
â”‚   â”œâ”€â”€ workflow.py         # å·¥ä½œæµ
â”‚   â”œâ”€â”€ dataset.py          # æ•°æ®é›†
â”‚   â””â”€â”€ message.py          # æ¶ˆæ¯
â”œâ”€â”€ services/                # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ auth_service.py     # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ app_service.py      # åº”ç”¨æœåŠ¡
â”‚   â”œâ”€â”€ workflow_service.py # å·¥ä½œæµæœåŠ¡
â”‚   â””â”€â”€ dataset_service.py  # æ•°æ®é›†æœåŠ¡
â”œâ”€â”€ repositories/            # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ base_repository.py
â”œâ”€â”€ extensions/              # æ‰©å±•æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ ext_database.py     # æ•°æ®åº“æ‰©å±•
â”‚   â”œâ”€â”€ ext_redis.py        # Redis æ‰©å±•
â”‚   â””â”€â”€ ext_storage.py      # å­˜å‚¨æ‰©å±•
â”œâ”€â”€ libs/                    # å·¥å…·åº“
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ helper.py           # è¾…åŠ©å‡½æ•°
â”‚   â””â”€â”€ errors.py           # é”™è¯¯å¤„ç†
â”œâ”€â”€ tasks/                   # å¼‚æ­¥ä»»åŠ¡
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ celery_app.py
â”œâ”€â”€ migrations/              # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ versions/
â””â”€â”€ tests/                   # æµ‹è¯•ä»£ç 
    â”œâ”€â”€ __init__.py
    â””â”€â”€ unit/
```

#### 2.2 æ‰§è¡ŒåŠ¨ä½œ
```bash
cd api

# åˆ›å»ºæ‰€æœ‰ç›®å½•
mkdir -p configs controllers/{console/{auth,app,workspace,dataset},service/{completion,workflow}}
mkdir -p core/{app/{entities,features,runners},workflow/{nodes,engine,graph},rag/{datasource,retrieval,embedding},model_runtime/{providers,entities}}
mkdir -p models services repositories extensions libs tasks migrations/versions tests/unit

# åˆ›å»º __init__.py æ–‡ä»¶
find . -type d -exec touch {}/__init__.py \;
```

---

### æ­¥éª¤ 3ï¼šåˆ›å»ºå‰ç«¯åŸºç¡€ç»“æ„

#### 3.1 Web ç›®å½•ç»“æ„
```
web/
â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/              # è®¤è¯ç›¸å…³é¡µé¢
â”‚   â”‚   â”œâ”€â”€ signin/
â”‚   â”‚   â”œâ”€â”€ signup/
â”‚   â”‚   â””â”€â”€ layout.tsx
â”‚   â”œâ”€â”€ (commonLayout)/      # é€šç”¨å¸ƒå±€é¡µé¢
â”‚   â”‚   â”œâ”€â”€ apps/           # åº”ç”¨åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ workspace/      # å·¥ä½œç©ºé—´
â”‚   â”‚   â”œâ”€â”€ datasets/       # æ•°æ®é›†
â”‚   â”‚   â””â”€â”€ layout.tsx
â”‚   â”œâ”€â”€ install/            # å®‰è£…å‘å¯¼
â”‚   â”œâ”€â”€ layout.tsx          # æ ¹å¸ƒå±€
â”‚   â””â”€â”€ page.tsx            # é¦–é¡µ
â”œâ”€â”€ components/              # å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ base/               # åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ app/                # åº”ç”¨ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ workflow/           # å·¥ä½œæµç»„ä»¶
â”‚   â””â”€â”€ dataset/            # æ•°æ®é›†ç»„ä»¶
â”œâ”€â”€ context/                 # React Context
â”‚   â”œâ”€â”€ app-context.tsx
â”‚   â””â”€â”€ workflow-context.tsx
â”œâ”€â”€ hooks/                   # è‡ªå®šä¹‰ Hooks
â”‚   â”œâ”€â”€ use-auth.ts
â”‚   â””â”€â”€ use-workflow.ts
â”œâ”€â”€ service/                 # API æœåŠ¡
â”‚   â”œâ”€â”€ base.ts
â”‚   â”œâ”€â”€ auth.ts
â”‚   â”œâ”€â”€ app.ts
â”‚   â””â”€â”€ workflow.ts
â”œâ”€â”€ models/                  # æ•°æ®æ¨¡å‹å’Œç±»å‹
â”‚   â”œâ”€â”€ app.ts
â”‚   â””â”€â”€ workflow.ts
â”œâ”€â”€ types/                   # TypeScript ç±»å‹
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ request.ts
â”‚   â””â”€â”€ format.ts
â”œâ”€â”€ i18n/                    # å›½é™…åŒ–
â”‚   â”œâ”€â”€ zh-Hans.ts          # ç®€ä½“ä¸­æ–‡
â”‚   â””â”€â”€ en-US.ts            # è‹±æ–‡
â”œâ”€â”€ styles/                  # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ globals.css
â”œâ”€â”€ public/                  # é™æ€èµ„æº
â”‚   â”œâ”€â”€ logo/               # Logo æ–‡ä»¶
â”‚   â””â”€â”€ icons/              # å›¾æ ‡
â”œâ”€â”€ config/                  # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ package.json            # ä¾èµ–é…ç½®
â”œâ”€â”€ tsconfig.json           # TypeScript é…ç½®
â”œâ”€â”€ tailwind.config.js      # Tailwind é…ç½®
â”œâ”€â”€ next.config.js          # Next.js é…ç½®
â”œâ”€â”€ .env.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ Dockerfile              # Docker é•œåƒæ„å»º
```

#### 3.2 æ‰§è¡ŒåŠ¨ä½œ
```bash
cd web

# åˆ›å»ºç›®å½•ç»“æ„
mkdir -p app/{auth/{signin,signup},commonLayout/{apps,workspace,datasets},install}
mkdir -p components/{base,app,workflow,dataset}
mkdir -p context hooks service models types utils
mkdir -p i18n styles public/{logo,icons} config
```

---

### æ­¥éª¤ 4ï¼šåˆ›å»º Docker é…ç½®

#### 4.1 Docker ç›®å½•ç»“æ„
```
docker/
â”œâ”€â”€ docker-compose.yml       # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ .env.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ nginx/                  # Nginx é…ç½®
â”‚   â”œâ”€â”€ nginx.conf
â”‚   â””â”€â”€ conf.d/
â”‚       â””â”€â”€ default.conf
â”œâ”€â”€ postgres/               # PostgreSQL é…ç½®
â”‚   â””â”€â”€ init.sql
â”œâ”€â”€ redis/                  # Redis é…ç½®
â”‚   â””â”€â”€ redis.conf
â””â”€â”€ volumes/                # æ•°æ®å·æŒ‚è½½ç‚¹
    â”œâ”€â”€ postgres/
    â”œâ”€â”€ redis/
    â””â”€â”€ storage/
```

#### 4.2 æ‰§è¡ŒåŠ¨ä½œ
```bash
cd docker

# åˆ›å»ºé…ç½®ç›®å½•
mkdir -p nginx/conf.d postgres redis
mkdir -p volumes/{postgres,redis,storage}
```

---

### æ­¥éª¤ 5ï¼šåˆ›å»ºé…ç½®æ–‡ä»¶

#### 5.1 æ ¹ç›®å½•é…ç½®æ–‡ä»¶

**`.gitignore`**
```gitignore
# Python
__pycache__/
*.py[cod]
*.so
.Python
venv/
env/
*.egg-info/

# Node
node_modules/
.next/
out/
*.log

# ç¯å¢ƒå˜é‡
.env
.env.local

# IDE
.vscode/
.idea/
*.swp

# Docker
docker/volumes/

# ç³»ç»Ÿæ–‡ä»¶
.DS_Store
Thumbs.db
```

**`.editorconfig`**
```ini
root = true

[*]
charset = utf-8
end_of_line = lf
insert_final_newline = true
trim_trailing_whitespace = true

[*.{py,js,ts,tsx,json,yml,yaml}]
indent_style = space
indent_size = 2

[*.py]
indent_size = 4

[*.md]
trim_trailing_whitespace = false
```

**`README.md`**
```markdown
# Shadow Agents Platform

å½±å­æ™ºèƒ½ä½“å¹³å° - ä¸€ä¸ªå¼ºå¤§çš„ AI åº”ç”¨å¼€å‘å¹³å°

## ç®€ä»‹

Shadow Agents Platform æ˜¯ä¸€ä¸ªå¼€æºçš„ AI åº”ç”¨å¼€å‘å¹³å°ï¼Œæ”¯æŒå¿«é€Ÿæ„å»ºå’Œéƒ¨ç½² AI åº”ç”¨ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¤– å¤šç§åº”ç”¨ç±»å‹æ”¯æŒï¼ˆèŠå¤©åŠ©æ‰‹ã€æ–‡æœ¬ç”Ÿæˆã€Agentã€å·¥ä½œæµï¼‰
- ğŸ”§ å¯è§†åŒ–å·¥ä½œæµè®¾è®¡å™¨
- ğŸ“š çŸ¥è¯†åº“å’Œ RAG æ”¯æŒ
- ğŸ¨ ç®€æ´æ˜“ç”¨çš„ç•Œé¢
- ğŸ³ ç®€åŒ–çš„ Docker éƒ¨ç½²

## å¿«é€Ÿå¼€å§‹

è¯¦è§ [éƒ¨ç½²æŒ‡å—](docs/guides/deployment.md)

## æŠ€æœ¯æ ˆ

### åç«¯
- Python 3.11+
- Flask
- SQLAlchemy
- Celery

### å‰ç«¯
- React 18+
- Next.js 14+
- TypeScript
- Tailwind CSS

## æ–‡æ¡£

- [æ¶æ„è®¾è®¡](docs/architecture/)
- [éƒ¨ç½²æŒ‡å—](docs/guides/deployment.md)
- [å¼€å‘æŒ‡å—](docs/guides/development.md)
- [API æ–‡æ¡£](docs/api-reference/)

## è®¸å¯è¯

MIT License

## è‡ªå®šä¹‰å“ç‰Œ

æœ¬å¹³å°æ”¯æŒå®Œå…¨è‡ªå®šä¹‰å“ç‰Œå…ƒç´ ï¼Œè¯¦è§ [å“ç‰Œå®šåˆ¶æŒ‡å—](docs/guides/branding.md)
```

#### 5.2 æ‰§è¡ŒåŠ¨ä½œ
```bash
# åœ¨æ ¹ç›®å½•åˆ›å»ºé…ç½®æ–‡ä»¶
cat > .gitignore << 'EOF'
# å†…å®¹å¦‚ä¸Š
EOF

cat > .editorconfig << 'EOF'
# å†…å®¹å¦‚ä¸Š
EOF

cat > README.md << 'EOF'
# å†…å®¹å¦‚ä¸Š
EOF
```

---

### æ­¥éª¤ 6ï¼šåˆå§‹åŒ–åŸºç¡€ä»£ç æ–‡ä»¶

#### 6.1 åç«¯åŸºç¡€æ–‡ä»¶

**`api/app.py`**
```python
"""
åº”ç”¨å…¥å£æ–‡ä»¶
"""
from app_factory import create_app

# åˆ›å»º Flask åº”ç”¨å®ä¾‹
app = create_app()

if __name__ == "__main__":
    # å¼€å‘æ¨¡å¼è¿è¡Œ
    app.run(host="0.0.0.0", port=5001, debug=True)
```

**`api/app_factory.py`**
```python
"""
Flask åº”ç”¨å·¥å‚
ç”¨äºåˆ›å»ºå’Œé…ç½® Flask åº”ç”¨å®ä¾‹
"""
from flask import Flask
from flask_cors import CORS

def create_app() -> Flask:
    """
    åˆ›å»º Flask åº”ç”¨å®ä¾‹
    
    Returns:
        Flask: é…ç½®å¥½çš„ Flask åº”ç”¨
    """
    app = Flask(__name__)
    
    # åŠ è½½é…ç½®
    app.config.from_object('configs.app_config')
    
    # åˆå§‹åŒ–æ‰©å±•
    initialize_extensions(app)
    
    # æ³¨å†Œè“å›¾
    register_blueprints(app)
    
    # æ³¨å†Œé”™è¯¯å¤„ç†
    register_error_handlers(app)
    
    return app

def initialize_extensions(app: Flask) -> None:
    """åˆå§‹åŒ– Flask æ‰©å±•"""
    # CORS
    CORS(app)
    
    # æ•°æ®åº“
    # å°†åœ¨åç»­æ­¥éª¤ä¸­å®ç°
    pass

def register_blueprints(app: Flask) -> None:
    """æ³¨å†Œè“å›¾ï¼ˆè·¯ç”±ï¼‰"""
    # å°†åœ¨åç»­æ­¥éª¤ä¸­å®ç°
    pass

def register_error_handlers(app: Flask) -> None:
    """æ³¨å†Œé”™è¯¯å¤„ç†å™¨"""
    # å°†åœ¨åç»­æ­¥éª¤ä¸­å®ç°
    pass
```

**`api/pyproject.toml`**
```toml
[project]
name = "shadow-agents-api"
version = "0.1.0"
description = "Shadow Agents Platform API"
requires-python = ">=3.11"

dependencies = [
    "flask>=3.0.0",
    "flask-cors>=4.0.0",
    "flask-sqlalchemy>=3.1.0",
    "sqlalchemy>=2.0.0",
    "celery>=5.3.0",
    "redis>=5.0.0",
    "psycopg2-binary>=2.9.0",
    "python-dotenv>=1.0.0",
]

[build-system]
requires = ["setuptools>=61.0"]
build-backend = "setuptools.build_meta"
```

#### 6.2 å‰ç«¯åŸºç¡€æ–‡ä»¶

**`web/package.json`**
```json
{
  "name": "shadow-agents-web",
  "version": "0.1.0",
  "description": "Shadow Agents Platform Web",
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "next": "^14.0.0",
    "typescript": "^5.0.0",
    "tailwindcss": "^3.4.0",
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0"
  }
}
```

**`web/next.config.js`**
```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  // ç¯å¢ƒå˜é‡
  env: {
    NEXT_PUBLIC_API_URL: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:5001',
  },
}

module.exports = nextConfig
```

**`web/tsconfig.json`**
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```

---

### æ­¥éª¤ 7ï¼šåˆ›å»º Docker é…ç½®æ–‡ä»¶

**`docker/docker-compose.yml`**
```yaml
version: '3.8'

services:
  # PostgreSQL æ•°æ®åº“
  postgres:
    image: postgres:15-alpine
    container_name: shadow-postgres
    environment:
      POSTGRES_DB: shadow_agents
      POSTGRES_USER: shadow
      POSTGRES_PASSWORD: shadow123456
    volumes:
      - ./volumes/postgres:/var/lib/postgresql/data
      - ./postgres/init.sql:/docker-entrypoint-initdb.d/init.sql
    ports:
      - "5432:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U shadow"]
      interval: 10s
      timeout: 5s
      retries: 5

  # Redis ç¼“å­˜
  redis:
    image: redis:7-alpine
    container_name: shadow-redis
    command: redis-server --requirepass shadow123456
    volumes:
      - ./volumes/redis:/data
    ports:
      - "6379:6379"
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5

  # API åç«¯
  api:
    build:
      context: ../api
      dockerfile: Dockerfile
    container_name: shadow-api
    environment:
      - DATABASE_URL=postgresql://shadow:shadow123456@postgres:5432/shadow_agents
      - REDIS_URL=redis://:shadow123456@redis:6379/0
      - SECRET_KEY=change-this-secret-key
    volumes:
      - ../api:/app
      - ./volumes/storage:/app/storage
    ports:
      - "5001:5001"
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
    command: python app.py

  # Web å‰ç«¯
  web:
    build:
      context: ../web
      dockerfile: Dockerfile
    container_name: shadow-web
    environment:
      - NEXT_PUBLIC_API_URL=http://localhost:5001
    ports:
      - "3000:3000"
    depends_on:
      - api
    command: npm run dev

  # Nginx åå‘ä»£ç†
  nginx:
    image: nginx:alpine
    container_name: shadow-nginx
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./nginx/conf.d:/etc/nginx/conf.d
    ports:
      - "80:80"
    depends_on:
      - api
      - web

volumes:
  postgres:
  redis:
  storage:
```

---

## éªŒè¯æ£€æŸ¥æ¸…å•

å®ŒæˆåŸºç¡€ç»“æ„åˆ›å»ºåï¼Œéœ€è¦éªŒè¯ï¼š

- [ ] æ‰€æœ‰ç›®å½•ç»“æ„å·²åˆ›å»º
- [ ] åŸºç¡€é…ç½®æ–‡ä»¶å·²å°±ä½
- [ ] Python ç¯å¢ƒå¯ä»¥åˆå§‹åŒ–ï¼ˆè™šæ‹Ÿç¯å¢ƒï¼‰
- [ ] Node.js ä¾èµ–å¯ä»¥å®‰è£…
- [ ] Docker Compose é…ç½®è¯­æ³•æ­£ç¡®
- [ ] Git ä»“åº“å·²åˆå§‹åŒ–
- [ ] README æ–‡æ¡£å†…å®¹æ¸…æ™°

---

## ä¸‹ä¸€æ­¥

å®ŒæˆåŸºç¡€ç»“æ„åï¼Œè¿›å…¥ï¼š
ğŸ‘‰ **é˜¶æ®µä¸‰ï¼šå¤åˆ» API åç«¯æ ¸å¿ƒåŠŸèƒ½**
